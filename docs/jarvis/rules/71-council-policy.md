# 71-council-policy.md â€” AI Council Consultation Policy

**Version:** 1.0
**Last Updated:** 2026-02-03
**Priority:** CRITICAL (System-level enforcement)

---

## ğŸ“‹ Overview

This policy defines **mandatory** AI Council consultation requirements to prevent errors, ensure quality, and leverage collective intelligence.

**AI Council Members:**
- ğŸ¦ ã‚¯ãƒ­ãƒƒãƒ”ãƒ¼ (Claude Opus 4.5 via claude.ai)
- ğŸ’ ã‚¸ã‚§ãƒŸãƒ¼ (Gemini 2.0 Flash)
- ğŸ§  ãƒãƒ£ãƒƒãƒ”ãƒ¼ (ChatGPT 4)

---

## ğŸ”‘ Rule 14: AI Council MUST USE council: PREFIX

**Status:** MANDATORY (System-level enforcement)

### Consultation Method

**âœ… REQUIRED:**
- Use `council:` prefix in Telegram message
- Send message directly to get real-time responses from 3 AIs
- Format: `council: [your question]`

**âŒ PROHIBITED:**
- Creating documents and "waiting for responses"
- Sending individual files to each AI
- 24-hour waiting period
- Document-based consultation approach

### Why This Rule Exists

The previous document-based consultation method was inefficient:
- Required manual file creation and distribution
- Needed 24-hour waiting period
- Missed real-time collaboration benefits

The `council:` prefix approach is:
- âœ… Real-time responses (3 AIs respond immediately)
- âœ… Automatic integration into conversation context
- âœ… No manual file management
- âœ… Faster decision-making

---

## ğŸš¨ MANDATORY Consultation Triggers

### 1. å®Ÿè£…é–‹å§‹å‰ï¼ˆREQUIREDï¼‰

**When:**
- æ–°ã—ã„æ©Ÿèƒ½ãƒ»ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…ã‚’é–‹å§‹ã™ã‚‹å‰
- æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ ã¸ã®é‡å¤§ãªå¤‰æ›´ã‚’åŠ ãˆã‚‹å‰
- ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ä¸Šã®åˆ¤æ–­ãŒå¿…è¦ãªæ™‚

**Question Format:**
```
council: ã“ã®å®Ÿè£…ã‚’é–‹å§‹ã—ã¾ã™ã€‚è¨­è¨ˆä¸Šã®æ‡¸å¿µç‚¹ã‚„æ³¨æ„ã™ã¹ããƒã‚¤ãƒ³ãƒˆã‚’æ•™ãˆã¦ãã ã•ã„ã€‚

ã‚¿ã‚¹ã‚¯: [å®Ÿè£…å†…å®¹]
ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ: [äºˆå®šã—ã¦ã„ã‚‹è¨­è¨ˆãƒ»æ–¹é‡]
å½±éŸ¿ç¯„å›²: [å¤‰æ›´ã•ã‚Œã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ã‚·ã‚¹ãƒ†ãƒ ]

ç°¡æ½”ã«ï¼ˆ3-5è¡Œä»¥å†…ã§ï¼‰é‡è¦ãªãƒã‚¤ãƒ³ãƒˆã®ã¿ã‚’æŒ‡æ‘˜ã—ã¦ãã ã•ã„ã€‚
```

**Why Mandatory:**
- è¨­è¨ˆãƒŸã‚¹ã®æ—©æœŸç™ºè¦‹
- ã‚ˆã‚Šè‰¯ã„ä»£æ›¿æ¡ˆã®ç™ºè¦‹
- è¦‹è½ã¨ã—ãŒã¡ãªæ‡¸å¿µç‚¹ã®æŒ‡æ‘˜
- å®Ÿè£…å¾Œã®æ‰‹æˆ»ã‚Šã‚’é˜²æ­¢

---

### 2. ã‚¨ãƒ©ãƒ¼ãƒ»ä¸å…·åˆç™ºç”Ÿæ™‚ï¼ˆREQUIREDï¼‰

**When:**
- å®Ÿè£…ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸæ™‚
- ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ãŸæ™‚
- äºˆæœŸã—ãªã„å‹•ä½œãŒç™ºç”Ÿã—ãŸæ™‚
- 2å›ä»¥ä¸ŠåŒã˜ã‚¨ãƒ©ãƒ¼ãŒç¹°ã‚Šè¿”ã™æ™‚

**Question Format:**
```
council: ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚è§£æ±ºæ–¹æ³•ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚

ã‚¨ãƒ©ãƒ¼å†…å®¹: [ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸]
ç™ºç”Ÿç®‡æ‰€: [ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»é–¢æ•°å]
è©¦ã—ãŸã“ã¨: [æ—¢ã«è©¦ã—ãŸå¯¾å‡¦]
ç’°å¢ƒ: [é–¢é€£ã™ã‚‹è¨­å®šãƒ»ãƒãƒ¼ã‚¸ãƒ§ãƒ³]

æ ¹æœ¬åŸå› ã¨æ¨å¥¨ã•ã‚Œã‚‹è§£æ±ºç­–ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚
```

**Why Mandatory:**
- ã‚¨ãƒ©ãƒ¼ã®æ ¹æœ¬åŸå› åˆ†æ
- ã‚ˆã‚Šå®‰å…¨ãªè§£æ±ºç­–ã®é¸æŠ
- åŒã˜ã‚¨ãƒ©ãƒ¼ã®å†ç™ºé˜²æ­¢
- ãƒ‡ãƒãƒƒã‚°æ™‚é–“ã®çŸ­ç¸®

---

### 3. Confidence < 0.8 ã®å ´åˆï¼ˆSTRONGLY RECOMMENDEDï¼‰

**When:**
- å®Ÿè£…æ–¹é‡ã«è‡ªä¿¡ãŒæŒã¦ãªã„æ™‚
- è¤‡æ•°ã®é¸æŠè‚¢ãŒã‚ã‚Šåˆ¤æ–­ã«è¿·ã†æ™‚
- æœªçŸ¥ã®é ˜åŸŸãƒ»æ–°ã—ã„æŠ€è¡“ã‚’ä½¿ã†æ™‚

**Question Format:**
```
council: ä»¥ä¸‹ã®åˆ¤æ–­ã«ã¤ã„ã¦åŠ©è¨€ã‚’ãã ã•ã„ã€‚

çŠ¶æ³: [ç¾åœ¨ã®çŠ¶æ³]
é¸æŠè‚¢:
  A) [é¸æŠè‚¢A]
  B) [é¸æŠè‚¢B]
  C) [é¸æŠè‚¢C]

ã©ã®é¸æŠè‚¢ãŒæœ€é©ã‹ã€ã¾ãŸã¯ã‚ˆã‚Šè‰¯ã„ä»£æ›¿æ¡ˆãŒã‚ã‚Œã°æ•™ãˆã¦ãã ã•ã„ã€‚
```

---

## âœ… Consultation Process

### 1. Trigger Detection
- auto-rules.ts ã® `handlePreImplementationConsultation()` ãŒè‡ªå‹•æ¤œå‡º
- ã¾ãŸã¯æ‰‹å‹•ã§ `council:` ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹ã‚’ä½¿ç”¨

### 2. Question Preparation
- **æœ€å°é™ã®æƒ…å ±**ã§è³ªå•ï¼ˆTRUNCATIONè€æ€§ï¼‰
- Pinned Snapshotï¼ˆè¦ç‚¹ã®ã¿ï¼‰
- è¨ˆç”»ï¼ˆPlanï¼‰ã®è¦ç´„
- å¤‰æ›´å·®åˆ†ï¼ˆdiffäºˆå®š/å½±éŸ¿ç¯„å›²ï¼‰

### 3. Council Response Collection
- 3ã¤ã®AIã«ä¸¦è¡Œã§è³ªå•é€ä¿¡
- å„AIã®å¿œç­”ã‚’åé›†
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: 30ç§’/AI

### 4. Response Integration
- Jarvis ãŒ3ã¤ã®å¿œç­”ã‚’çµ±åˆ
- å…±é€šã™ã‚‹æ‡¸å¿µç‚¹ã®æŠ½å‡º
- æœ€çµ‚åˆ¤æ–­ã‚’æç¤º

### 5. Decision Record
- AI Council ã®åŠ©è¨€ã‚’ AI_MEMORY ã«è¨˜éŒ²
- å®Ÿè£…åˆ¤æ–­ã®æ ¹æ‹ ã¨ã—ã¦ä¿æŒ
- Learning Log ã«è¿½åŠ ï¼ˆPhase 4ï¼‰

---

## ğŸš« Consultation Skip Conditions

ä»¥ä¸‹ã®å ´åˆã®ã¿ã€ç›¸è«‡ã‚’ã‚¹ã‚­ãƒƒãƒ—å¯èƒ½ï¼š

1. **æ˜ç¤ºçš„ãªã‚¹ã‚­ãƒƒãƒ—æŒ‡ç¤º**
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€Œç›¸è«‡ä¸è¦ã€ã€Œç›´æ¥å®Ÿè£…ã€ã¨æŒ‡ç¤º
   - ç·Šæ€¥å¯¾å¿œã§æ™‚é–“ãŒãªã„å ´åˆ

2. **è»½å¾®ãªå¤‰æ›´**
   - ã‚¿ã‚¤ãƒä¿®æ­£
   - ã‚³ãƒ¡ãƒ³ãƒˆè¿½åŠ 
   - ãƒ­ã‚°å‡ºåŠ›è¿½åŠ 
   - æ—¢å­˜ãƒ­ã‚¸ãƒƒã‚¯ã®ç§»å‹•ã®ã¿

3. **Recent Consultation (10åˆ†ä»¥å†…)**
   - åŒã˜ã‚¿ã‚¹ã‚¯ã§10åˆ†ä»¥å†…ã«æ—¢ã«ç›¸è«‡æ¸ˆã¿
   - `consultationHistory` ã§è‡ªå‹•åˆ¤å®š

---

## ğŸ¯ Confidence Score Calculation

```typescript
interface ConfidenceScore {
  score: number;        // 0.0 - 1.0
  impact: number;       // 0.0 - 1.0 (å¤‰æ›´ã®å½±éŸ¿åº¦)
  complexity: number;   // 0.0 - 1.0 (å®Ÿè£…ã®è¤‡é›‘åº¦)
  novelty: number;      // 0.0 - 1.0 (æ–°è¦æ€§)
}

// Consultation required if:
// - impact >= 0.7 && score < 0.7
// - score < 0.5
// - novelty >= 0.8
```

**Impact Factors:**
- Gatewayæœ¬ç•ªå¤‰æ›´: 0.9
- Botæœ¬ç•ªå¤‰æ›´: 0.7
- æ–°è¦ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè¿½åŠ : 0.8
- æ—¢å­˜ãƒ­ã‚¸ãƒƒã‚¯å¤‰æ›´: 0.6
- æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«è¿½åŠ : 0.4
- ãƒ†ã‚¹ãƒˆè¿½åŠ : 0.2

---

## ğŸ“ Examples

### Example 1: å®Ÿè£…é–‹å§‹å‰

```
council: Autopilot Engine v1 ã®å®Ÿè£…ã‚’é–‹å§‹ã—ã¾ã™ã€‚è¨­è¨ˆä¸Šã®æ‡¸å¿µç‚¹ã‚„æ³¨æ„ã™ã¹ããƒã‚¤ãƒ³ãƒˆã‚’æ•™ãˆã¦ãã ã•ã„ã€‚

ã‚¿ã‚¹ã‚¯: Autopilot Engine Coreå®Ÿè£…
ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ:
- Pipeline: Triggerâ†’Contextâ†’Planâ†’Reviewâ†’Proposeâ†’Executeâ†’Learn
- Context Manager: Snapshotå¸¸æ™‚ + Queryå¿…è¦æ™‚ã®ã¿
- Approval UX: Telegramã‚«ãƒ¼ãƒ‰ + ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ãƒœã‚¿ãƒ³
- Action Ledger: å…¨å‰¯ä½œç”¨ã‚’dedupeã—ã¦äºŒé‡å®Ÿè¡Œé˜²æ­¢

å½±éŸ¿ç¯„å›²:
- ~/claude-telegram-bot/src/autopilot/engine.ts (æ–°è¦)
- ~/claude-telegram-bot/src/utils/action-ledger.ts (æ–°è¦)
- auto-rules.ts (æ‹¡å¼µ)

ç°¡æ½”ã«ï¼ˆ3-5è¡Œä»¥å†…ã§ï¼‰é‡è¦ãªãƒã‚¤ãƒ³ãƒˆã®ã¿ã‚’æŒ‡æ‘˜ã—ã¦ãã ã•ã„ã€‚
```

### Example 2: ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚

```
council: D1ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚è§£æ±ºæ–¹æ³•ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚

ã‚¨ãƒ©ãƒ¼å†…å®¹: "Cannot read properties of undefined (reading 'prepare')"
ç™ºç”Ÿç®‡æ‰€: ~/memory-gateway/src/janitor.ts:128
è©¦ã—ãŸã“ã¨:
- env.STORAGE â†’ env.DB ã«å¤‰æ›´
- wrangler.toml ã® bindingåç¢ºèª

ç’°å¢ƒ: Cloudflare Workers + D1

æ ¹æœ¬åŸå› ã¨æ¨å¥¨ã•ã‚Œã‚‹è§£æ±ºç­–ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚
```

### Example 3: é¸æŠè‚¢ã®åˆ¤æ–­

```
council: Memory Gateway ã®å®Ÿè£…æ–¹é‡ã«ã¤ã„ã¦åŠ©è¨€ã‚’ãã ã•ã„ã€‚

çŠ¶æ³: æ—¢å­˜å®Ÿè£…ã¨æ–°ä»•æ§˜ã«å·®ç•°ãŒã‚ã‚‹
é¸æŠè‚¢:
  A) æ—¢å­˜å®Ÿè£…ã‚’æ´»ç”¨ã—ã¦é«˜é€Ÿã«é€²ã‚ã‚‹ï¼ˆãƒ†ãƒ¼ãƒ–ãƒ«åãƒ»ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã¯æ—¢å­˜ã®ã¾ã¾ï¼‰
  B) æ–°ä»•æ§˜é€šã‚Šã«æ–°ã—ã„ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¦ç§»è¡Œ

ã©ã®é¸æŠè‚¢ãŒæœ€é©ã‹ã€ã¾ãŸã¯ã‚ˆã‚Šè‰¯ã„ä»£æ›¿æ¡ˆãŒã‚ã‚Œã°æ•™ãˆã¦ãã ã•ã„ã€‚
```

---

## ğŸ”„ Integration with Existing Systems

### auto-rules.ts Integration

Rule 9: Proactive AI Council Consultation
- å®Ÿè£…ç³»ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œå‡º
- å‘½ä»¤å½¢ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º
- è‡ªå‹•ã§ council ã«ç›¸è«‡
- åŠ©è¨€ã‚’ context ã«ä¿å­˜

### Confidence Router (Phase 4)

```typescript
async function shouldConsultCouncil(
  task: Task,
  confidence: ConfidenceScore
): Promise<boolean> {
  // Mandatory triggers
  if (task.isImplementation && !task.hasConsulted) return true;
  if (task.hasError && task.errorCount >= 2) return true;

  // Confidence-based
  if (confidence.impact >= 0.7 && confidence.score < 0.7) return true;
  if (confidence.score < 0.5) return true;
  if (confidence.novelty >= 0.8) return true;

  return false;
}
```

---

## ğŸ“Š Success Metrics

**Target:**
- å®Ÿè£…å‰ç›¸è«‡ç‡: 100% (for major implementations)
- ã‚¨ãƒ©ãƒ¼æ™‚ç›¸è«‡ç‡: 100% (for repeated errors)
- æ‰‹æˆ»ã‚Šå‰Šæ¸›ç‡: 80%
- å®Ÿè£…æ™‚é–“çŸ­ç¸®: 30% (by avoiding mistakes)

**Tracking:**
- `consultationHistory` Map
- Learning Log (Phase 4)
- AI_MEMORY è¨˜éŒ²

---

## ğŸ“ Learning & Improvement

### Learning Log Schema

```typescript
interface CouncilConsultationLog {
  task_id: string;
  consulted_at: string;
  question: string;
  advisors: {
    croppy: string;
    gemmy: string;
    chatty: string;
  };
  decision: string;
  result: 'success' | 'partial' | 'failed';
  learning: string[];
  reuse_score: number; // 0-1
}
```

### Weekly Review

æ¯é€±æ—¥æ›œæ—¥ã«ï¼š
- ç›¸è«‡å›æ•°ãƒ»æˆåŠŸç‡ã‚’é›†è¨ˆ
- é »å‡ºã™ã‚‹æ‡¸å¿µç‚¹ã‚’æŠ½å‡º
- ãƒ«ãƒ¼ãƒ«ãƒ»é–¾å€¤ã‚’æ›´æ–°
- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æ”¹å–„

---

## ğŸš€ Implementation Status

- [x] Rule 13 in AGENTS.md
- [x] Rule 14: council: prefix usage (2026-02-04)
- [x] docs/jarvis/rules/71-council-policy.md
- [x] auto-rules.ts Rule 9 (Proactive consultation)
- [ ] Confidence Router (Phase 4)
- [ ] Learning Log (Phase 4)
- [ ] Weekly Review automation (Phase 5)

---

**Next Steps:**
1. Enforce Rule 14 (council: prefix) in all AI Council consultations
2. Monitor consultation effectiveness
3. Iterate on question templates
4. Build Confidence Router (Phase 4)
5. Automate Learning Log (Phase 4)
